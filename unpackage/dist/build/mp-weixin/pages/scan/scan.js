(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scan/scan"],{"0d61":function(e,t,o){"use strict";var n=o("cf45"),s=o.n(n);s.a},"3e2d":function(e,t,o){"use strict";(function(e){o("8d82");n(o("66fd"));var t=n(o("62ed"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"62ed":function(e,t,o){"use strict";o.r(t);var n=o("ccea"),s=o("e661");for(var i in s)"default"!==i&&function(e){o.d(t,e,(function(){return s[e]}))}(i);o("0d61");var r,c=o("f0c5"),a=Object(c["a"])(s["default"],n["b"],n["c"],!1,null,"425a2305",null,!1,n["a"],r);t["default"]=a.exports},ccea:function(e,t,o){"use strict";var n,s=function(){var e=this,t=e.$createElement;e._self._c},i=[];o.d(t,"b",(function(){return s})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return n}))},cf45:function(e,t,o){},e200:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("4795")),s=o("ae66");function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,o,n,s,i,r){try{var c=e[i](r),a=c.value}catch(u){return void o(u)}c.done?t(a):Promise.resolve(a).then(n,s)}function c(e){return function(){var t=this,o=arguments;return new Promise((function(n,s){var i=e.apply(t,o);function c(e){r(i,n,s,c,a,"next",e)}function a(e){r(i,n,s,c,a,"throw",e)}c(void 0)}))}}var a={name:"scan",data:function(){return{imgUrl:s.config.staticUrl,qrcode:"",openid:"",ydLocation:!1,needLocation:!1,againClick:!1,isOnLoad:!1,longitude:"",latitude:"",accuracy:"",userInfo:{avatarUrl:"",nickName:""}}},onLoad:function(t){console.log(this.imgUrl),console.log(t.q),console.log(decodeURIComponent(t.q));var o=decodeURIComponent(t.q);this.$store.commit("getQr",o),console.log("二维码"+this.$store.state.qr);var n=this;if(-1!=o.indexOf("xt.vjifen.com"))-1!=o.indexOf("/LN/")?n.qrcode=o.split("LN/")[1]:n.qrcode=o.split("v=")[1];else if(-1!=o.indexOf("VJ1.TV/LN/"))n.qrcode=o.split("LN/")[1];else{if(-1==o.indexOf("vj1.tv/LN/"))return n.qrcode="",e.showModal({title:"温馨提示",content:"请扫描正确的活动二维码~",showCancel:!1,success:function(t){t.confirm&&e.reLaunch({url:"../home/home"})}});n.qrcode=o.split("LN/")[1]}console.log(n.qrcode),n.$store.commit("getQrcode",n.qrcode),n.isOnLoad=!0;var s="LN";n.$store.commit("getProvinceCode",s),console.log("province"+this.$store.state.provinceCode),e.getStorage({key:"userInfo",success:function(e){console.log(e.data);e.data;n.userInfo.avatarUrl=e.data.avatarUrl,n.userInfo.nickName=e.data.nickName},fail:function(e){n.userInfo.avatarUrl="",n.userInfo.nickName=""}})},onShareAppMessage:function(){return{title:"青岛啤酒辽宁",path:"/pages/home/home",imageUrl:this.imgUrl+"share.png"}},onShow:function(){var t=this;return c(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:t.isOnLoad&&"LN"==t.$store.state.provinceCode&&(t.openid=t.$store.state.openid,console.log(t.openid),t.openid?t.getLocation():e.navigateTo({url:"../getOpenid/getOpenid?provinceCode="+t.$store.state.provinceCode+"&type=openid"}));case 1:case"end":return o.stop()}}),o)})))()},created:function(){},mounted:function(){this.$store.dispatch("xcxOpenidGet")},methods:{getLocation:function(){var t=this;e.getLocation({type:"wgs84",complete:function(e){console.log(e),t.longitude=e.longitude,t.latitude=e.latitude,t.accuracy=e.accuracy,console.log(t.qrcode),"getLocation:ok"==e.errMsg?(console.log("latitude".concat(e.latitude,",longitude").concat(e.longitude)),-1!=t.qrcode.indexOf("MS_")?t.sweepMS(e.longitude,e.latitude):t.sweep(e.longitude,e.latitude)):"getLocation:fail auth deny"==e.errMsg||"getLocation:fail authorize no response"==e.errMsg?t.getSetting():"getLocation:fail:auth denied"==e.errMsg?-1!=t.qrcode.indexOf("MS_")?t.sweepMS():t.sweep():t.ydLocation=!0}})},closeLocationTip:function(){var t=this;this.ydLocation=!1,e.showModal({title:"温馨提示",content:"开启手机定位有机会获得更大的红包哦~，确定不开启手机定位参与本次扫码活动吗？",cancelText:"先开定位",cancelColor:"#808080",confirmText:"直接参与",confirmColor:"#4CD964",complete:function(o){console.log(o),o.confirm?-1!=t.qrcode.indexOf("MS_")?t.sweepMS():t.sweep():e.switchTab({url:"../home/home"})}})},getSetting:function(){var t=this;e.getSetting({complete:function(e){if(console.log(e),e.authSetting){if(0==e.authSetting["scope.userLocation"])t.needLocation=!0,t.againClick&&(-1!=t.qrcode.indexOf("MS_")?t.sweepMS():t.sweep());else if(void 0==e.authSetting["scope.userLocation"])return-1!=t.qrcode.indexOf("MS_")?t.sweepMS():t.sweep()}else-1!=t.qrcode.indexOf("MS_")?t.sweepMS():t.sweep()}})},openset:function(){var t=this;return c(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:t.againClick=!0,e.openSetting({complete:function(e){}});case 2:case"end":return o.stop()}}),o)})))()},getMsg:function(){e.getStorage({key:"userMsg",complete:function(e){console.log("getMsg"+e)}})},cancel:function(){var e=this;return c(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("取消打开授权设置"),e.againClick=!0,-1!=e.qrcode.indexOf("MS_")?e.sweepMS():e.sweep();case 3:case"end":return t.stop()}}),t)})))()},sweep:function(t,o){var i=this;return c(n.default.mark((function r(){var c,a,u;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.showLoading({title:"红包加载中"}),c={openid:i.$store.state.openid,paOpenid:i.$store.state.xcxopenid,sweepstr:i.qrcode,longitude:void 0===t?"00":i.longitude,latitude:void 0===o?"00":i.latitude,projectServerName:"liaoning",nickname:i.userInfo.nickName,headimgurl:i.userInfo.avatarUrl},n.next=4,(0,s.post)("/sweep/sweepQrcode",c);case 4:a=n.sent,console.log(a),e.hideLoading(),console.log("sweepQrcode",a),i.$store.dispatch("sweepResult",a),console.log(i.$store.state.sweepData),u=i.$store.state.sweepData.reply,a=i.$store.state.sweepData.result,0==a.businessCode?e.redirectTo({url:"../result/getcash?bizcode="+a.businessCode}):11==a.businessCode?e.redirectTo({url:"../result/getcash?bizcode="+a.businessCode}):7==a.businessCode?u.username?e.redirectTo({url:"../result/prize?bizcode="+a.businessCode+"&isWrite=true"}):"重复扫码"==a.msg?e.redirectTo({url:"../result/prize?bizcode="+a.businessCode+"&isWrite=false"}):e.redirectTo({url:"../result/prize?bizcode="+a.businessCode}):15==a.businessCode?e.redirectTo({url:"../result/fail?bizcode=2"}):12==a.businessCode?e.redirectTo({url:"../result/getMsg?bizcode="+a.businessCode}):13==a.businessCode?e.redirectTo({url:"../result/getMsg?bizcode="+a.businessCode}):30==a.businessCode?e.redirectTo({url:"../result/verification?bizcode="+a.businessCode}):e.redirectTo({url:"../result/fail?bizcode="+a.businessCode});case 13:case"end":return n.stop()}}),r)})))()},sweepMS:function(t,o){var i=this;return c(n.default.mark((function t(){var o,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showLoading({title:"红包加载中"}),console.log(i.$store.state.provinceCode),i.$store.state.provinceCode,o={openid:i.$store.state.openid,paOpenid:i.$store.state.xcxopenid,sweepstr:i.qrcode,longitude:void 0===i.longitude?"00":i.longitude,latitude:void 0===i.latitude?"00":i.latitude,projectServerName:"liaoning"},t.next=6,(0,s.post)("/vpoints/seckill/sweepQrcode",o);case 6:r=t.sent,e.hideLoading(),console.log("seckill sweepQrcode",r),i.$store.dispatch("sweepResult",r),console.log(i.$store.state.sweepData),i.$store.state.sweepData.reply,r=i.$store.state.sweepData.result,0==r.businessCode?e.redirectTo({url:"../result/getcash?bizcode="+r.businessCode}):11==r.businessCode?e.redirectTo({url:"../result/getcash?bizcode="+r.businessCode}):7==r.businessCode?r.reply.username?e.redirectTo({url:"../result/prize?bizcode="+res.data.result.businessCode+"&isWrite=true"}):"重复扫码"==r.msg?e.redirectTo({url:"../result/prize?bizcode="+r.businessCode+"&isWrite=false"}):e.redirectTo({url:"../result/getcash?bizcode="+r.businessCode}):15==r.businessCode?e.redirectTo({url:"../result/fail?bizcode=2"}):12==r.businessCode?e.redirectTo({url:"../result/getMsg?bizcode="+r.businessCode}):13==r.businessCode?e.redirectTo({url:"../result/getMsg?bizcode="+r.businessCode}):30==r.businessCode?e.redirectTo({url:"../result/verification?bizcode="+r.businessCode}):e.redirectTo({url:"../result/fail?bizcode="+r.businessCode});case 14:case"end":return t.stop()}}),t)})))()}}};t.default=a}).call(this,o("543d")["default"])},e661:function(e,t,o){"use strict";o.r(t);var n=o("e200"),s=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);t["default"]=s.a}},[["3e2d","common/runtime","common/vendor"]]]);